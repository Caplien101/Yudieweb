<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halaman Berikutnya</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --hover-color: #1d4ed8;
        }
        body {
            background-color: #f8f9fa;
            padding: 16px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 12px;
        }
        .table-container {
            max-height: 75vh; /* Maksimum tinggi tabel 3/4 layar */
            overflow-y: auto; /* Aktifkan scroll vertikal */
            border: 1px solid #dee2e6; /* Tambahkan border untuk estetika */
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h3 class="text-center mb-4 fw-bold text-primary">Data Produk dari Halaman Sebelumnya</h3>
        <div class="table-container">
            <table class="table table-hover">
    <thead class="table-light">
        <tr>
            <th>PLU</th>
            <th>Deskripsi</th>
            <th>OH</th>
        </tr>
    </thead>
    <tbody id="dataTable"></tbody>
</table>
        </div>

        <!-- Tombol Next Page -->
        <div class="mt-4 text-end">
            <button id="nextPageBtn" class="btn btn-success">Next Page</button>
        </div>
    </div>

    <script>
        
        // Ambil data dari sessionStorage
const filteredProductData = sessionStorage.getItem('filteredProductData');

if (!filteredProductData) {
    alert("Tidak ada data yang ditemukan!");
} else {
    // Parse data dari JSON
    const products = JSON.parse(filteredProductData);

    // Masukkan data ke dalam tabel
    const dataTable = document.getElementById("dataTable");
    products.forEach((item, index) => {
        const row = dataTable.insertRow();
        row.innerHTML = `
            <td>${item.plu}</td>
            <td>${item.description}</td>
            <td><input type="number" class="form-control oh-input" value="${item.oh || 0}" min="0" data-index="${index}"></td>
        `;
    });

    // Simpan data produk ke variabel global
    window.products = products;

    // Event listener untuk input OH
    const ohInputs = document.querySelectorAll('.oh-input');
    ohInputs.forEach(input => {
        input.addEventListener('change', (event) => {
            const index = event.target.dataset.index;
            const newOH = parseInt(event.target.value);

            if (isNaN(newOH) || newOH < 0) {
                alert("Nilai OH harus berupa angka positif!");
                event.target.value = products[index].oh || 0; // Kembalikan ke nilai sebelumnya
                return;
            }

            // Update nilai OH di data produk
            products[index].oh = newOH;

            // Perbarui data di sessionStorage
            sessionStorage.setItem('filteredProductData', JSON.stringify(products));
        });
    });
}

        // Event listener untuk tombol "Next Page"
        document.getElementById('nextPageBtn').addEventListener('click', function () {
    // Ambil data dari sessionStorage
    const filteredProductData = sessionStorage.getItem('filteredProductData');

    if (!filteredProductData) {
        alert("Tidak ada data yang dapat dibawa ke halaman berikutnya!");
        return;
    }

    // Parse data dari JSON
    const products = JSON.parse(filteredProductData);

    // Tampilkan struktur data di console
    console.log("Struktur data yang akan dikirim:", products);

   

    // Simpan data ke sessionStorage untuk digunakan di Halaman 3
    sessionStorage.setItem('filteredProductData', JSON.stringify(products));

    // Redirect ke Halaman 3
    window.location.href = 'another-page.html';
});
        
        const selectedRak = sessionStorage.getItem('selectedRak') || '-';
console.log("Rak yang dipilih:", selectedRak);
    </script>
</body>
</html>
