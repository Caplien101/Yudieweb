<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Link Yudie</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --primary: #667eea;
      --primary-dark: #5a67d8;
      --danger: #e53e3e;
      --success: #48bb78;
      --gray-light: #f8f9fa;
      --gray: #e2e8f0;
      --text: #2d3748;
      --text-light: #718096;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--primary) 0%, #764ba2 100%);
      color: #333;
      min-height: 100vh;
      padding: 16px;
      line-height: 1.6;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    header {
      background: #4a5568;
      color: white;
      padding: 24px 20px;
      text-align: center;
    }

    header h1 {
      font-weight: 600;
      font-size: clamp(1.5rem, 4vw, 2rem); /* Responsif: 24px ‚Üí 32px */
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .content {
      padding: 20px;
    }

    .password-section {
      text-align: center;
      margin-bottom: 24px;
    }

    .password-section input {
      padding: 14px;
      width: 100%;
      max-width: 300px;
      border: 2px solid var(--gray);
      border-radius: 12px;
      font-size: 16px;
      outline: none;
      transition: border-color 0.3s;
    }

    .password-section input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }

    .password-section button {
      margin-top: 12px;
      padding: 14px 24px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: background 0.3s;
    }

    .password-section button:hover {
      background: var(--primary-dark);
    }

    .form-add {
      display: none;
      background: var(--gray-light);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 24px;
      border: 1px solid var(--gray);
    }

    .form-add h3 {
      margin-bottom: 16px;
      color: var(--text);
      font-size: 1.25rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-add input {
      width: 100%;
      padding: 14px;
      margin: 8px 0;
      border: 1px solid var(--gray);
      border-radius: 8px;
      font-size: 16px;
    }

    .form-add button {
      background: var(--success);
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
    }

    .form-add button:hover {
      opacity: 0.9;
    }

    .links-container {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .link-item {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 16px;
      background: var(--gray-light);
      border-left: 4px solid var(--primary);
      border-radius: 8px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    @media (min-width: 600px) {
      .link-item {
        flex-direction: row;
        align-items: center;
      }
    }

    .link-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    .link-item a {
      font-size: 1rem;
      font-weight: 500;
      color: #2b6cb0;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      word-break: break-all;
    }

    .link-item a i {
      color: var(--primary);
    }

    .edit-controls {
      display: none;
      margin-top: 10px;
    }

    .edit-mode .edit-controls {
      display: flex;
      justify-content: flex-end;
      margin-top: 10px;
    }

    @media (min-width: 600px) {
      .edit-controls {
        margin-top: 0;
      }
    }

    .btn-delete {
      background: var(--danger);
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .loader {
      text-align: center;
      color: var(--text-light);
      padding: 24px;
      font-size: 1rem;
    }

    .footer {
      text-align: center;
      padding: 16px;
      color: var(--text-light);
      font-size: 0.875rem;
      background: var(--gray-light);
      border-top: 1px solid var(--gray);
    }

    /* Prevent zoom on mobile input focus */
    input {
      -webkit-text-size-adjust: 100%;
    }

    @media (max-width: 480px) {
      body {
        padding: 12px;
      }
      .container {
        border-radius: 12px;
      }
      header h1 {
        font-size: 1.4rem;
      }
      .password-section input,
      .password-section button {
        font-size: 16px;
        padding: 12px;
      }
      .form-add input {
        font-size: 15px;
      }
      .link-item {
        padding: 14px;
      }
      .link-item a {
        font-size: 0.95rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1><i class="fas fa-link"></i>Kumpulan Link Laporan</h1>
      <h7>klik untuk menuju link laporan</h7>
    </header>

    <div class="content">
      <!-- Password Input -->
      <div class="password-section">
        <input type="password" id="password" placeholder="Login untuk menambahkan link" />
        <button id="btn-toggle-edit"><i class="fas fa-sign-in-alt"></i> Masuk</button>
      </div>

      <!-- Form Tambah Link -->
      <div class="form-add" id="form-add">
        <h3><i class="fas fa-plus-circle"></i> Tambah Link Baru</h3>
        <input type="text" id="link-name" placeholder="Nama link, contoh: Google" />
        <input type="url" id="link-url" placeholder="https://example.com" />
        <button id="btn-add-link">Tambahkan</button>
      </div>

      <!-- Daftar Link -->
      <div id="links-container">
        <div class="loader">Memuat link...</div>
      </div>
    </div>

    <div class="footer">
      Dibuat dengan ‚ù§ untuk kamu
    </div>
  </div>

  <script>
    // üîê Password kamu
    const PASSWORD = "rahasia123"; // Ganti sesuai keinginan

    // üåê Ganti dengan URL Web App dari Google Apps Script
    const API_URL = "https://script.google.com/macros/s/AKfycbyTanogmnJmqsoDVq_IYh2BtnIAGa11-VXRpFFWP_6g_0lK_FsZgxje83GGKUIsM-3eOQ/exec";

    // DOM Elements
    const passwordInput = document.getElementById("password");
    const btnToggleEdit = document.getElementById("btn-toggle-edit");
    const formAdd = document.getElementById("form-add");
    const linkName = document.getElementById("link-name");
    const linkUrl = document.getElementById("link-url");
    const btnAddLink = document.getElementById("btn-add-link");
    const linksContainer = document.getElementById("links-container");

    // Ambil data dari Google Sheets
    async function loadLinks() {
      try {
        const res = await fetch(API_URL);
        const data = await res.json();
        renderLinks(data.links);
      } catch (err) {
        linksContainer.innerHTML = `<div class="loader">Gagal memuat data. Coba lagi nanti.</div>`;
        console.error(err);
      }
    }

    // Render links
    function renderLinks(links) {
      if (links.length === 0) {
        linksContainer.innerHTML = "<div class='loader'>Belum ada link.</div>";
        return;
      }

      linksContainer.innerHTML = "";
      links.forEach((link, index) => {
        const div = document.createElement("div");
        div.className = "link-item";

        const a = document.createElement("a");
        a.href = link.url;
        a.target = "_blank";
        a.innerHTML = `<i class="fas fa-external-link-alt"></i> ${link.name}`;

        const controls = document.createElement("div");
        controls.className = "edit-controls";
        controls.innerHTML = `
          <button class="btn-delete" data-index="${index}">
            <i class="fas fa-trash"></i> Hapus
          </button>
        `;

        div.appendChild(a);
        div.appendChild(controls);
        linksContainer.appendChild(div);
      });

      // Event delete
      document.querySelectorAll(".btn-delete").forEach(btn => {
        btn.addEventListener("click", async function () {
          const index = this.dataset.index;
          if (confirm("Hapus link ini?")) {
            await fetch(API_URL, {
              method: "POST",
              body: JSON.stringify({
                action: "delete",
                index: parseInt(index)
              })
            });
            loadLinks(); // refresh
          }
        });
      });
    }

    // Toggle edit mode
    btnToggleEdit.addEventListener("click", () => {
      if (passwordInput.value === PASSWORD) {
        formAdd.style.display = "block";
        document.body.classList.add("edit-mode");
        passwordInput.disabled = true;
        passwordInput.value = "";
        passwordInput.placeholder = "Mode edit aktif";
        btnToggleEdit.style.display = "none";
      } else {
        alert("Password salah!");
      }
    });

    // Tambah link
    btnAddLink.addEventListener("click", async () => {
      const name = linkName.value.trim();
      const url = linkUrl.value.trim();

      if (!name || !url) return alert("Isi semua field!");
      if (!url.startsWith("http://") && !url.startsWith("https://")) {
        return alert("Gunakan http:// atau https://");
      }

      try {
        await fetch(API_URL, {
          method: "POST",
          body: JSON.stringify({
            action: "add",
            name,
            url
          })
        });
        linkName.value = "";
        linkUrl.value = "";
        loadLinks(); // refresh daftar
      } catch (err) {
        alert("Gagal menambahkan link. Cek koneksi atau coba lagi.");
        console.error(err);
      }
    });

    // Load saat pertama kali
    loadLinks();
  </script>
</body>
</html>
